# 다중회귀분석

- 다중회귀분석: 독립변수가 두개 이상인 경우

  - 여러개의 독립변수를 이용하면 종속변수의 변화를 더 잘 설명할 수 있음
  - 회귀 모형은 범주형 독립변수 **포함 가능**(> 더미변수를 이용)

- 다중선형회귀모형으로의 확장

  - 다중 선형회귀모형

    - Copyright by Multicampus Co., Ltd. All right reserved

    - 독립변수가 두개이상인선형회귀모형.

    - 여러개의독립변수를 이용하면종속변수의 변화에 대한 설명력 증가

    - 자료$((𝑥_{1𝑖}, 𝑥_{2i}, ⋯ , 𝑥_{𝑘𝑖}), 𝑌_𝑖) , 𝑖 = 1, ⋯ , 𝑛$ 에 다음의 관계식이 성립한다고 가정함.$𝑌_𝑖 =\alpha + \beta_1 𝑥_{1𝑖} + \beta_2 𝑥_{2𝑖} + ⋯ + \beta_𝑘 𝑥_{𝑘𝑖} + \epsilon_𝑖$          $(𝑖 = 1,2, … , 𝑛)$

      $(\alpha + \beta_1 𝑥_{1𝑖} + \beta_2 𝑥_{2𝑖} + ⋯ + \beta_𝑘 𝑥_{𝑘𝑖})$ = $E[Y_i]$ -기댓값

  - 다중 선형회귀모형

    - 오차항인 $\epsilon_1, \epsilon_2,...,\epsilon_n$은 서로 독립인 확률 변수$\epsilon_i\sim N[0,\sigma^2]$ :  정규, 등분산, 독립
    - 회귀계수 α, $\beta_1,...,\beta_k$, 와 𝜎2 은 미지인 모수로 상수임.
    - $\beta_j$ 의해석 :  $x_j$ 를 제외한 나머지 모든 예측변수들을 **상수로 고정시킨 상태**에서 $𝑥_𝑗$ 의 한 단위증가에 따른 $𝐸[𝑌]$의 증분을 의미 (𝑗 = 1, … , 𝑘).

- 회계계수 $\alpha, \beta_1,...,\beta_k$의 추정

  - 수직거리 제곱합

    - $SS(\alpha,\beta_1,...\beta_k)=\sum^n_{i=1}{(y_i-\alpha-\beta_1x_{1i}-\cdots-\beta_kx_{ki})^2}$ 이 최소가 되도록 𝛼, $\beta_1, … , \beta_𝑘$ 를 추정.

    - 최소제곱 추정량 : $\widehat{\alpha},\widehat{\beta_1},...,\widehat{\beta_k}$

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/94536acf-e853-42f1-adc1-c13d081b11a8/Untitled.png)

- 다중회귀모형 분석 예시

  - 현재 영업중인 La Quinta Inn 호텔 중에서 랜덤하게 100곳의 영업자료를 수집
  - 다중회귀 모형의 설정
  - $𝑀𝑎𝑟𝑔𝑖𝑛 = \alpha + \beta_1𝑁𝑢𝑚𝑏𝑒𝑟 + \beta_2𝑁𝑒𝑎𝑟𝑒𝑠𝑡+\beta_3𝑂𝑓𝑓𝑖𝑐𝑒 + \beta_4𝐶𝑜𝑙𝑙𝑒𝑔𝑒 + \beta_5𝐼𝑛𝑐𝑜𝑚𝑒 + \beta_6𝐷𝑖𝑠𝑡𝑡𝑤𝑛 + \epsilon$

  ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6015aa85-9b93-4159-9394-4eaf2811ca80/Untitled.png)

  - 다중선형회귀모형 추정결과

    - $margin = 38.14 − 0.0076𝑁𝑢𝑚𝑏𝑒𝑟 + 1.65𝑁𝑒𝑎𝑟𝑒𝑠𝑡+0.020𝑂𝑓𝑓𝑖𝑐𝑒 𝑆𝑝𝑎𝑐𝑒 + 0.21𝐸𝑛𝑟𝑜𝑙𝑙𝑚𝑒𝑛𝑡 + 0.41𝐼𝑛𝑐𝑜𝑚e−0.23𝐷𝑖𝑠𝑡𝑎𝑛𝑐e$

    - $\widehat{\alpha}=38.14.$ 수학적인 해석은 모든 x값이 0일 때의 Profit Margin의 예상 값(평균추정값)

      - 모든 x가 0인 게 관찰되지않았기때문에 해석하지 않음

    - $\widehat{\beta_1}=-0.0076.$ **다른변수는 고정되어 있고**, 반경3마일이내 호텔객실이 1개 증가하면, 영업이익율은 평균0.0076% 감소.

    - $\widehat{\beta_2}=1.65.$ **다른변수는 고정되어 있고**, 경쟁호텔과의 거리가 1마일 증가하면, 영업이익율은 평균1.65% 증가.

    - $\widehat{\beta_3}=0.02.$ **다른변수는 고정되어 있고**, 사무실 면적이 100평방피트 증가하면, 영업이익율은 평균0.02% 증가.

    - $\widehat{\beta_4}=0.21.$ **다른변수는 고정되어 있고**, 대학생거주자수가1000명 증가하면, 영업이익율은 평균0.21% 증가.

    - $\widehat{\beta_5}=0.41.$ **다른변수는 고정되어 있고**, 중간가구소득이 $1000 높은지역은, 영업이익율이 평균 0.41% 증가.

    - $\widehat{\beta_6}=-0.23.$ **다른변수는 고정되어 있고**, 다운타운 중심으로부터 1마일멀어질수록, 영업이익율은 평균0.23% 감소

    - $R^2=\frac{SSR}{SST}=1-\frac{SSE}{SST}=0.5251$

      영업이익율은 6개 설명변수에 의해 52.51% 설명됨.

- 범주형 독립변수가 포함된 회귀모형

  - 범주형 독립변수를 회귀모형에 포함하기 위해서는 더미변수 (dummy variable) 기법을 사용.

  - 더미변수는 0 또는 1의 값을 갖는 변수로 아래와 같이 정의됨.

    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/952057c1-3598-4c3f-b16e-85bfdba6334d/Untitled.png)

  - 범주형 독립변수 예시 : 중고차 가격에 관한 예측 모형

    - 중고차 시장에서 차량의 주행거리와 색상이 차량의 가격에 어떤 영향을 미치는지를 파악하고자 2013년형 A브랜드 중고차 100대에 관한 자료를 수집
    - 종속변수 : Price(가격)
    - 독립변수 : Odometer(주행거리)
    - Color(차량색상, 범주형 : white/silver/other)
    - Color의 더미변수 : 범주의 수가 3개
      - 2개의 더미변수($D_1, D_2$)를 생성
      - $D_1 =\begin{cases}1 & white인 경우\\0 & white가 아닌 경우\end{cases}$
      - $D_2 =\begin{cases}1 & silver인 경우\\0 & silver가 아닌 경우\end{cases}$
      - Other인 경우 : $D_1=0$   $\&$       $D_2 = 0$
    - 𝑃𝑅𝐼𝐶𝐸 = 16701 − .0555(𝑂𝑑𝑜𝑚𝑒𝑡𝑒𝑟) + 90.48($𝐷_1$) + 295.48($𝐷_2$)
      - ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4b81b042-07a5-472d-a45f-d2c36462f5ac/Untitled.png)