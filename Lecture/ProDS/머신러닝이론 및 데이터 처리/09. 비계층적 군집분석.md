비계층적 군집분석

K-평균 군집분석

사전에 결정된 군집 수 k에 기초하여, 전체 데이터를 상대적으로 유사한 k 개의 군집으로 구분.

계층적 방식에 비하여 계산량이 적고, 대용량 데이터를 빠르게 처리함.

사전에 적절한 군집 수 k에 대한 예상이 필요. 초기에 군집 중심이 어디로 지정되는지에 따라 최종 결과가 영향을 많이 받음.

잡음이나 이상치의 영향을 많이 받음

K-평균 군집분석 알고리즘

개체를 k 개의 초기 군집으로 나눈다.

각 군집의 중심(centroid)을 계산한 뒤 모든 개체들을 각 군집의 중심에 가장 가까운 군집에 할당시킨다.

새로운 개체를 받아들이거나 잃은 군집의 중심을 다시 계산한다.

위 과정을 더 이상의 재배치가 생기지 않을 때까지 반복한다

![img](notion://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5018de86-8a42-4a52-ae28-070d93ad9f56%2FUntitled.png?table=block&id=bf8ef1a9-f457-41f6-b189-77be643b0081&spaceId=c7987d2e-d7c1-414f-810c-4a45d9a07b1c&width=2000&userId=e00705ae-8039-435a-bf31-9148d652d269&cache=v2)



캡션

원본



(k -means clustering Method) 예시

①임의로𝑘=2 개의군집(AB), (CD)로분할.

②각군집의중심을계산.

(AB)의 중심: 𝑥 1 = 2, 𝑥 2 = 2

(CD)의 중심: 𝑥 1 = −1, 𝑥 2 = −2

③각 개체에 대하여, 각 군집 중심과의 거리를 계산.

<A> : (AB)에 더가까움. 𝑑 A,(AB) = \sqrt{(5-2)^2+(3-2)^2}=\sqrt{10}(5−2)2+(3−2)2=10﻿ 𝑑 A,(CD) =\sqrt{(5+1)^2+(3+2)^2}=\sqrt{61}(5+1)2+(3+2)2=61﻿

<B> : (CD)에더가까움. 𝑑 B,(AB) = \sqrt{(-1-2)^2+(1-2)^2}=\sqrt{10}(−1−2)2+(1−2)2=10﻿ 𝑑 B,(CD) = \sqrt{(-1+1)^2+(1+2)^2}=\sqrt{9}(−1+1)2+(1+2)2=9﻿

<C>: (CD)에 더가까움. 𝑑 C,(AB) = \sqrt{17}17﻿ 𝑑 C,(CD) = \sqrt{4}4﻿

 <D>: (CD)에 더가까움. 𝑑 D,(AB) = \sqrt{41}41﻿ 𝑑 D,(CD) = \sqrt{4}4﻿

④B는 군집 (CD)에 더 가까우므로, B를 (CD)에 통합하여 (BCD) 군집으로 정의. 나머지 개체는 변화가 없으므로 변동 없음.

⑤ 다시 군집의 중심값 계산.

(A)의 중심 :𝑥 1 = 5, 𝑥 2 = 3

(BCD)의 중심 :𝑥 1 = −1, 𝑥 2 = −1

⑥ 군집중심에서각개체간의거리를계산

|      | A           | B           | C           | D           |
| ---- | ----------- | ----------- | ----------- | ----------- |
| A    | \sqrt{0}0   | \sqrt{40}40 | \sqrt{41}41 | \sqrt{89}89 |
| BCD  | \sqrt{52}52 | \sqrt{4}4   | \sqrt{5}5   | \sqrt{5}5   |







⑦ 다른군집중심에더가까운개체가없으므로종료. 최종군집은(A)와(BCD)가 됨.

K-평균 군집분석에서 적절한 군집 수의 결정

오차제곱합(SSE, sum of squared error)

각군집내개체들과해당군집중심점과의거리를제곱한값들의합.

오차제곱합이작을수록군집내유사성이높아잘응집된것임.

군집수 k에 따른 SSE의 변화를 Elbow 차트로 시각화한 뒤, SSE가 급격히 감소하다가 완만해지기 시작하는 시점의 k를 적정 군집수로 판단함.

![img](notion://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0fd025e2-fc48-431b-9a12-d330c5428a75%2FUntitled.png?table=block&id=3abb0450-aab7-49c5-934f-54184e975122&spaceId=c7987d2e-d7c1-414f-810c-4a45d9a07b1c&width=480&userId=e00705ae-8039-435a-bf31-9148d652d269&cache=v2)



캡션

원본