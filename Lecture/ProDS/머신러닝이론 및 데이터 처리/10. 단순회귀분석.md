# 단순회귀분석

- 단순 선형 회귀(Simple Linear Regression) : 특성변수 X 하나만 가지고, 연속형 종속변수 Y를 예측하는 모델

- 회귀분석 개요

  - 회귀분석

    - 독립변수와 종속변수 간의 함수적인 관련성을 규명하기 위하여 어떤 수학적 모형을 가정하고, 이 모형을 측정된 자료로부터 통계적으로 추정하는 분석방법.

    - 𝑦=𝑓(𝑥)의 함수 관계가 있을 때,

      - 𝑥를 설명변수(explanatory variable) 또 는독립변수(independent variable) 또는 예측변수, 특성 변수

        - 단순 회귀 : 독립변수가 1개
        - 다중 회귀 : 독립변수가 2개 이상

      - 𝑦를반응 변수(response variable) 또는종속 변수(dependent variable) 또는 목표변수, 타겟변수

        ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8b9c3990-fc7d-49de-bb56-0dc7b4ab2f59/Untitled.png)

- 단순선형회귀모형

  - 모형 정의 및 가정

    - 자료($𝑥_𝑖, 𝑌_𝑖$), 𝑖=1,⋯, 𝑛 에 다음의 관계식이 성립한다고 가정함

    $Y_i=\alpha+\beta x_i+\epsilon_i , i = 1,2,...,n$

    - 오차항인$\epsilon_1,\epsilon_2,\cdots,\epsilon_n$는 서로 독립인 확률변수로, $\epsilon_i ~N[0,\sigma^2]$ :정규, 등분산, 독립가정

    - $\alpha,\beta$는 회귀계수라 부르며 α는 절편, 𝛽는 기울기를 나타냄

    - α,𝛽, $\sigma^2$은 미지의 모수로, 상수임.

    - 자료$(𝑥_i,𝑌_i)$, 𝑖=1,⋯, 𝑛 에 다음의 관계식이 성립한다고 가정함. $𝑌_𝑖~𝑁[\alpha + \beta 𝑥_𝑖, \sigma^2] → 𝐸[𝑌_𝑖] = \alpha + \beta𝑥_i$

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ecfa0d7c-0092-4eb5-bc9e-4e4adeb2c0fe/Untitled.png)

- 단순 선형회귀모형의 모수 추정

  - 모수 추정

    - 모형이 포함한 미지의 모수 α,𝛽 를 추정하기 위하여 각 독립변수 $𝑥_𝑖$에 대응하는 종속변수 $𝑦_𝑖$로 짝지어진 𝑛 개의 표본인 관측치 ($𝑥_𝑖$, $𝑦_𝑖$) 가 주어짐

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/754ac3bc-4f86-40aa-a6bc-8fb60c562db6/Untitled.png)

  - 최소제곱법

    - 단순회귀모형 $Y_i=\alpha+\beta x_i+\epsilon_i$에서 자료점과 회귀선 간의 수직거리 제곱합 $SS(\alpha,\beta)=\Sigma^n_i(y_i-\alpha-\beta_i)^2$이 최소가 되도록 𝛼와 𝛽를 추정하는 방법

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d2536178-855f-4edf-ab5e-9522eee2266e/Untitled.png)

    - 𝛼에 대한 최소제곱 추정량 : $\widehat{\alpha} = \widehat{y}-\widehat{\beta} \overline{x}$

    - 𝛽에 대한 최소제곱 추정량 : $\widehat{\beta} = \frac{\Sigma^n_ix_i(y_i- \overline{y})}{\Sigma^n_ix_i(x_i- \overline{x})}$ (단, $\overline{x}는 x_i의 평균, \overline{y}는 y_i의 평균)$

    - $y_i$의 추정치 : $\widehat{y_i}=\widehat{\alpha}+\widehat{\beta}x_i , i =1,2,...,n$

    - 잔차 : $e_i = y_i-\widehat{y_i}=y_i-\widehat{\alpha}-\widehat{\beta}x_i , i=1,2,...,n$

      - 오차 $\epsilon$과 대응되는 개념으로써 오차는 확인이 불가능하지만 잔차는 확인이 가능

- 단순 선형회귀모형의 유의성 검정

  - 모형의 유의성 t 검정

    - 독립변수 𝑥가 종속변수 𝑌를 설명하기에 유용한 변수인가에 대한 통계적 추론은 회귀계수 𝛽에 대한 검정을 통해 파악할 수 있음.

    - 가설

      $𝐻_0$ ∶ 𝛽 = 0 $𝐻_1$ ∶ 𝛽 ≠ 0

    - 검정통계량과 표본분포

      - 귀무가설 $𝐻_0$ 이 사실일 때, $T=\frac{\widehat{\beta}}{\widehat{S.E.[\widehat{\beta}]}}$ ~ $t[n-2]$ $|T|=|\frac{\widehat{\beta}}{\widehat{S.E.[\widehat{\beta}]}}|$ > $t_{\alpha/2,n-2}$ 또는 p-value $(=P[T>|t_0|]\times 2) <\alpha$면 귀무가설을 기각 → 독립변수𝑥가종속변수𝑌를설명하기에유용한변수라고해석할수있음.

    > 𝑡𝛼 2,𝑛−2 또는 p-value (=P[𝑇>|t0|] × 2) < 𝛼면 → 독립변수𝑥가종속변수𝑌를설명하기에유용한변수라고해석할수있음.

- 단순선형회귀모형 사례

  - 예제

    - 베타에 관한 유의성을 유의수준 5%로 검정할 것.

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/daecf6e6-1e4d-4646-aec6-13a8309899b6/Untitled.png)

    - 가설 $𝐻_0$ ∶ 𝛽 = 0 $𝐻_1$ ∶ 𝛽 ≠ 0

    - 귀무가설($𝐻_0$)이사실일때,

    - 검정통계량의관찰값($x_0$)는9.464로𝑡[48]의분포에서 유의확률은1.49E-12

    - p-value(=1.49E-12) ≤ 𝛼(=0.05) 이므로, $𝐻_0$를기각

- 단순선형회귀모형의 적합도

  - Y의 변동성 분해

    - 제곱합:

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e5c69d0b-45f5-4add-92f9-75b5045164ac/Untitled.png)

      ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/aef59d38-be9c-452f-8ebe-11c619e7a0e0/Untitled.png)

  - 모형의 적합성

    - 결정계수 $R^2$ $R^2 =\frac{SSR}{SST}=1-\frac{SSE}{SST}$
    - 𝑆𝑆𝑇=𝑆𝑆𝑅+𝑆𝑆𝐸이므로 항상 0과1 사이의 값을 가짐(0≤$𝑅^2$≤1).
    - $𝑦_𝑖$의 변동 가운데 추정된 회귀모형으로 통해 설명되는 변동의 비중을 의미함.
    - 0에 가까울수록 추정된 모형의 설명력이 떨어지는 것으로, 1에 가까울수록 추정된 모형이 $𝑦_𝑖$의 변동을 완벽하게 설명하는 것으로 해석할 수 있음.
    - $𝑅^2$는 두 변수 간의 상관계수 𝑟의 제곱과 같음.